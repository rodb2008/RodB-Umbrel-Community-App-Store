services:
  # Added required proxy for Umbrel dashboard and Tor access
  app_proxy:
    image: getumbrel/app-proxy:1.0.0
    restart: unless-stopped
    environment:
      APP_HOST: gopool-container
      APP_PORT: 23443 # Port your app's web UI is listening on
    networks:
      - umbrel_main_network

  gopool:
    image: rodb2008com/gopool:latest
    container_name: gopool-container
    restart: unless-stopped
    # Use Umbrel's internal network to communicate with other apps/proxy
    networks:
      - umbrel_main_network
    ports:
      - "23080:23080"
      - "23443:23443"
      - "23456:23456"
      - "24333:24333"
      - "24443:24443"
    volumes:
      # Use absolute variable for app-specific data
      - ${APP_DATA_DIR}/data:/app/data
      - ${APP_DATA_DIR}/scripts:/app/scripts
      - ${APP_DATA_DIR}/logo.png:/app/logo.png:ro
      # Correct host path for Bitcoin cookie on Umbrel
      - /home/umbrel/umbrel/app-data/bitcoin/data/bitcoin/.cookie:/home/umbrel/.cookie:ro
    environment:
      - APP_ENV=production

networks:
  umbrel_main_network:
    external: true
    name: umbrel_main_network
